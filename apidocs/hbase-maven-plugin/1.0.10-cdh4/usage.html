<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.3 at Jan 23, 2013 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>hbase-maven-plugin - </title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20130123" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                hbase-maven-plugin
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
            
                <div class="xleft">
        <span id="publishDate">Last Published: 2013-01-23</span>
                  &nbsp;| <span id="projectVersion">Version: 1.0.10-hadoop1</span>
                      </div>
            <div class="xright">        
            
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
            
                                <h5>Overview</h5>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="Introduction">Introduction</a>
            </li>
                  <li class="none">
                          <a href="plugin-info.html" title="Goals">Goals</a>
            </li>
                  <li class="none">
            <strong>Usage</strong>
          </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                        <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                                          <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                   
            
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>Usage<a name="Usage"></a></h2><p>This plugin is useful for integration testing code that interacts with an HBase cluster. Typically, you will bind the `start` goal to your `pre-integration-test` phase and the `stop` goal to the `post-integration-test` phase of the maven build lifecycle.</p><div class="section"><h3>Referencing the maven repository hosted by WibiData<a name="Referencing_the_maven_repository_hosted_by_WibiData"></a></h3><p>Built artifacts are hosted on WibiData's maven repository, so you don't need to download the source and install the plugin manually. To tell maven about the repository from which to download this plugin, add the following to your ~/.m2/settings.xml or your project's pom.xml:</p><div class="source"><pre>    &lt;pluginRepositories&gt;
      &lt;pluginRepository&gt;
        &lt;id&gt;kiji-plugins&lt;/id&gt;
        &lt;name&gt;kiji-plugins&lt;/name&gt;
        &lt;url&gt;https://repo.wibidata.com/artifactory/kiji&lt;/url&gt;
      &lt;/pluginRepository&gt;
    &lt;/pluginRepositories&gt;</pre></div></div><div class="section"><h3>Start HBase during the integration-test phase<a name="Start_HBase_during_the_integration-test_phase"></a></h3><p>To bind the goals to their default phases (pre- and post-integration-test), add the following to the build plugins section of your pom.xml file:</p><div class="source"><pre>    &lt;build&gt;
      &lt;plugins&gt;
        &lt;!-- ... --&gt;
        &lt;plugin&gt;
          &lt;groupId&gt;org.kiji.maven.plugins&lt;/groupId&gt;
          &lt;artifactId&gt;hbase-maven-plugin&lt;/artifactId&gt;
          &lt;version&gt;${version}&lt;/version&gt;
          &lt;executions&gt;
            &lt;execution&gt;
              &lt;goals&gt;
                &lt;goal&gt;start&lt;/goal&gt;
                &lt;goal&gt;stop&lt;/goal&gt;
              &lt;/goals&gt;
            &lt;/execution&gt;
          &lt;/executions&gt;
        &lt;/plugin&gt;
        &lt;!-- ... --&gt;
      &lt;/plugins&gt;
    &lt;/build&gt;</pre></div></div><div class="section"><h3>Start a MapReduce cluster during the integration-test phase<a name="Start_a_MapReduce_cluster_during_the_integration-test_phase"></a></h3><p>You may also require a mini MapReduce cluster to be started alongside your HBase cluster. To configure the plugin to do so, set mapReduceEnabled to true in your configuration:</p><div class="source"><pre>    &lt;plugin&gt;
      &lt;groupId&gt;org.kiji.maven.plugins&lt;/groupId&gt;
      &lt;artifactId&gt;hbase-maven-plugin&lt;/artifactId&gt;
      &lt;version&gt;${version}&lt;/version&gt;
      &lt;configuration&gt;
        &lt;mapReduceEnabled&gt;true&lt;/mapReduceEnabled&gt;
      &lt;/configuration&gt;
      &lt;!-- ... --&gt;
    &lt;/plugin&gt;</pre></div></div><div class="section"><h3>Hadoop configuration for your cluster<a name="Hadoop_configuration_for_your_cluster"></a></h3><p>You might want to specify additional server-side Hadoop configuration for the cluster. You may use the <i>hadoopConfiguration</i> properties to set them. For example, to increase the number of map and reduce task slots:</p><div class="source"><pre>    &lt;plugin&gt;
      &lt;groupId&gt;org.kiji.maven.plugins&lt;/groupId&gt;
      &lt;artifactId&gt;hbase-maven-plugin&lt;/artifactId&gt;
      &lt;version&gt;${version}&lt;/version&gt;
      &lt;configuration&gt;
        &lt;hadoopConfiguration&gt;
          &lt;property&gt;
            &lt;name&gt;mapred.tasktracker.map.tasks.maximum&lt;/name&gt;
            &lt;value&gt;16&lt;/value&gt;
          &lt;/property&gt;
          &lt;property&gt;
            &lt;name&gt;mapred.tasktracker.reduce.tasks.maximum&lt;/name&gt;
            &lt;value&gt;8&lt;/value&gt;
          &lt;/property&gt;
        &lt;/hadoopConfiguration&gt;
        &lt;mapReduceEnabled&gt;true&lt;/mapReduceEnabled&gt;
      &lt;/configuration&gt;
      &lt;!-- ... --&gt;
    &lt;/plugin&gt;</pre></div></div><div class="section"><h3>Using the mini cluster from your Java tests<a name="Using_the_mini_cluster_from_your_Java_tests"></a></h3><p>The `start` goal will write an XML configuration file named `hbase-site.xml` to your `target/test-classes` directory, which appears on the classpath when your tests are run. Hence, an `org.apache.hadoop.conf.Configuration` object created via `HBaseConfiguration.create()` will load the HBase cluster configuration automatically.</p><div class="source"><pre>    Configuration conf = HBaseConfiguration.create();
    HTable mytable = new HTable(conf, &quot;mytable&quot;);
    // Operate on mytable as usual...</pre></div></div><div class="section"><h3>Logging<a name="Logging"></a></h3><p>By default, the plugin and the clusters it starts write their logs to the following locations within your project:</p><ul><li>target/hbase-maven-plugin.log - The plugin log.</li><li>target/hbase.log - The HBase log.</li><li>target/mapred.log - The MapReduce log.</li></ul></div><div class="section"><h3>MapReduce task logs<a name="MapReduce_task_logs"></a></h3><p>Jobs run on the MapReduce cluster started by the plugin produce task logs that may be useful for debugging but that are deleted when the cluster is shutdown. These logs are written to the location given by the Hadoop configuration property `hadoop.tmp.dir`. Setting `saveHadoopTmpDir` to `true` in the plugin's configuration or setting `-Dsave.hadoop.tmp=true` on the command line will clear the directory given by `hadoop.tmp.dir` before the cluster is started and copy the contents of `hadoop.tmp.dir` to the directory `hadoop-tmp` in your project's build directory. Task logs can be found at `$<a name="project.build.directory">project.build.directory</a>/hadoop-tmp/userlogs`.</p><div class="source"><pre>    &lt;plugin&gt;
      &lt;groupId&gt;org.kiji.maven.plugins&lt;/groupId&gt;
      &lt;artifactId&gt;hbase-maven-plugin&lt;/artifactId&gt;
      &lt;version&gt;${version}&lt;/version&gt;
      &lt;configuration&gt;
        &lt;hadoopConfiguration&gt;
          &lt;property&gt;
            &lt;name&gt;mapred.tasktracker.map.tasks.maximum&lt;/name&gt;
            &lt;value&gt;16&lt;/value&gt;
          &lt;/property&gt;
          &lt;property&gt;
            &lt;name&gt;mapred.tasktracker.reduce.tasks.maximum&lt;/name&gt;
            &lt;value&gt;8&lt;/value&gt;
          &lt;/property&gt;
        &lt;/hadoopConfiguration&gt;
        &lt;mapReduceEnabled&gt;true&lt;/mapReduceEnabled&gt;
        &lt;saveHadoopTmpDir&gt;true&lt;/saveHadoopTmpDir&gt;
      &lt;/configuration&gt;
      &lt;!-- ... --&gt;
    &lt;/plugin&gt;</pre></div></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2013
                        <a href="http://www.wibidata.com">WibiData, Inc.</a>.
            All Rights Reserved.      
            
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
